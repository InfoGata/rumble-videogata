(()=>{var t={};Object.defineProperty(t,"__esModule",{value:!0}),t.toSeconds=t.end=t.parse=t.pattern=void 0;var e="\\d+",a="".concat(e,"(?:[\\.,]").concat(e,")?"),n="(".concat(e,"Y)?(").concat(e,"M)?(").concat(e,"W)?(").concat(e,"D)?"),i="T(".concat(a,"H)?(").concat(a,"M)?(").concat(a,"S)?"),o="P(?:".concat(n,"(?:").concat(i,")?)"),r=["years","months","weeks","days","hours","minutes","seconds"],s=Object.freeze({years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0});t.pattern=new RegExp(o);t.parse=function(e){var a=e.replace(/,/g,".").match(t.pattern);if(!a)throw new RangeError("invalid duration: ".concat(e));var n=a.slice(1);if(0===n.filter((function(t){return null!=t})).length)throw new RangeError("invalid duration: ".concat(e));if(n.filter((function(t){return/\./.test(t||"")})).length>1)throw new RangeError("only the smallest unit can be fractional");return n.reduce((function(t,e,a){return t[r[a]]=parseFloat(e||"0")||0,t}),{})};t.end=function(t,e){void 0===e&&(e=new Date);var a=Object.assign({},s,t),n=e.getTime(),i=new Date(n);i.setFullYear(i.getFullYear()+a.years),i.setMonth(i.getMonth()+a.months),i.setDate(i.getDate()+a.days);var o=36e5*a.hours,r=6e4*a.minutes;return i.setMilliseconds(i.getMilliseconds()+1e3*a.seconds+o+r),i.setDate(i.getDate()+7*a.weeks),i};t.toSeconds=function(e,a){void 0===a&&(a=new Date);var n=Object.assign({},s,e),i=a.getTime(),o=new Date(i);return((0,t.end)(n,o).getTime()-o.getTime())/1e3},t.default={end:t.end,toSeconds:t.toSeconds,pattern:t.pattern,parse:t.parse};const c=async e=>{const a=`https://rumble.com/${e}`;let n=await application.getCorsProxy();n||(n="https://cloudcors.audio-pwa.workers.dev?url=");const i=await fetch(`${n}${a}`),o=await i.text(),r=(new DOMParser).parseFromString(o,"text/html"),s=r.querySelector('script[type="application/ld+json"]'),c=JSON.parse(s?.textContent||"").filter((t=>"VideoObject"===t["@type"]))[0],l=(c.embedUrl?.toString()||"").split("/").slice(0,-1).slice(-1)[0],d=c.uploadDate?.toString(),u=c.name?.toString(),p=c.duration?.toString();let m=0;p&&(m=(0,t.toSeconds)((0,t.parse)(p)));const g=c.url?.toString(),h=c.thumbnailUrl?.toString();let w;c.interactionStatistic&&"userInteractionCount"in c.interactionStatistic&&(w=c.interactionStatistic.userInteractionCount?.valueOf());const y=r.getElementsByClassName("media-heading-name")[0].textContent||"";r.getElementsByClassName("media-by--a")[0];return{title:u||"",channelName:y,duration:m,apiId:l,uploadDate:d,images:h?[{url:h}]:void 0,originalUrl:g,views:w}};application.onUiMessage=async t=>{switch(t.type){case"geturl":!function(t){application.postUiMessage(t)}({type:"videoid",videoId:await async function(t){return(await c(t)).apiId||""}(t.apiId)});break;case"endvideo":application.endVideo()}};const l=t=>{const e=t.getElementsByClassName("video-item--title")[0]?.textContent||"",a=t.getElementsByClassName("video-item--duration")[0]?.getAttribute("data-value"),n=function(t){for(var e=t.split(":"),a=0,n=1;e.length>0;)a+=n*parseInt(e.pop()||"0",10),n*=60;return a}(a||"0"),i=t.getElementsByClassName("video-item--img")[0]?.src,o=t.getElementsByClassName("video-item--a")[0]?.getAttribute("href")?.substring(1).split("0")[0];return{title:e,duration:n,apiId:o,images:[{url:i}]}},d=async t=>{const e=`https://rumble.com/search/videos?q=${t.query}`;let a=await application.getCorsProxy();a||(a="https://cloudcors.audio-pwa.workers.dev?url=");const n=await fetch(`${a}${e}`),i=await n.text(),o=(new DOMParser).parseFromString(i,"text/html");return{items:Array.from(o.getElementsByClassName("video-listing-entry")).map(l)}};application.onSearchAll=async t=>{const e=d(t),[a]=await Promise.all([e]);return{videos:a}},application.onSearchVideos=d,application.onGetVideo=async t=>await c(t.apiId)})();