(()=>{application.onUiMessage=async t=>{switch(t.type){case"geturl":!function(t){application.postUiMessage(t)}({type:"videoid",videoId:await async function(t){const e=`https://rumble.com/${t}`;let a=await application.getCorsProxy();a||(a="https://cloudcors.audio-pwa.workers.dev?url=");const i=await fetch(`${a}${e}`),s=await i.text(),r=(new DOMParser).parseFromString(s,"text/html").querySelector('script[type="application/ld+json"]');return JSON.parse(r?.textContent||"").filter((t=>"VideoObject"===t["@type"]))[0].embedUrl.split("/").slice(0,-1).slice(-1)[0]}(t.apiId)});break;case"endvideo":application.endVideo()}};const t=t=>{const e=t.getElementsByClassName("video-item--title")[0].textContent||"",a=function(t){for(var e=t.split(":"),a=0,i=1;e.length>0;)a+=i*parseInt(e.pop()||"0",10),i*=60;return a}(t.getElementsByClassName("video-item--duration")[0].getAttribute("data-value")||"0"),i=t.getElementsByClassName("video-item--img")[0].src,s=t.getElementsByClassName("video-item--a")[0].getAttribute("href")?.substring(1).split("0")[0];return{title:e,duration:a,apiId:s,images:[{url:i}]}},e=async e=>{const a=`https://rumble.com/search/videos?q=${e.query}`;let i=await application.getCorsProxy();i||(i="https://cloudcors.audio-pwa.workers.dev?url=");const s=await fetch(`${i}${a}`),r=await s.text(),o=(new DOMParser).parseFromString(r,"text/html");return{items:Array.from(o.getElementsByClassName("video-listing-entry")).map(t)}};application.onSearchAll=async t=>{const a=e(t),[i]=await Promise.all([a]);return{videos:i}},application.onSearchVideos=e})();